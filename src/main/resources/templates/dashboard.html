<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org" th:replace="layout :: content">-->
<!--<div>-->
<!--    <h4>Dashboard</h4>-->

<!--    <div class="row g-3">-->
<!--        <div class="col-md-6">-->
<!--            <div class="card">-->
<!--                <div class="card-header">Мои продукты</div>-->
<!--                <div class="card-body">-->
<!--                    <a class="btn btn-primary btn-sm mb-2" th:href="@{/products/my}">Открыть список</a>-->
<!--                    <div th:if="${#lists.isEmpty(myProducts)}" class="text-muted">Пока пусто</div>-->
<!--                    <ul class="list-group" th:if="${!#lists.isEmpty(myProducts)}">-->
<!--                        <li class="list-group-item d-flex justify-content-between"-->
<!--                            th:each="p : ${myProducts}">-->
<!--                            <span th:text="${p.name()}"></span>-->
<!--                            <a th:href="@{/products/{id}(id=${p.productId()})}">карточка</a>-->
<!--                        </li>-->
<!--                    </ul>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--        <div class="col-md-6">-->
<!--            <div class="card">-->
<!--                <div class="card-header">Холодильники</div>-->
<!--                <div class="card-body">-->
<!--                    <ul class="list-group">-->
<!--                        <li class="list-group-item d-flex justify-content-between align-items-center"-->
<!--                            th:each="f : ${fridges}">-->
<!--              <span>-->
<!--                <b th:text="${f.name}"></b>-->
<!--                <span class="text-muted" th:text="${f.location}"></span>-->
<!--              </span>-->
<!--                            <span class="d-flex gap-2">-->
<!--                <form th:action="@{/fridges/{id}/join(id=${f.fridgeId})}" method="post">-->
<!--                  <button class="btn btn-outline-primary btn-sm" type="submit">Открыть</button>-->
<!--                </form>-->
<!--                <a class="btn btn-outline-secondary btn-sm" th:href="@{/fridges/{id}/map(id=${f.fridgeId})}">Карта</a>-->
<!--              </span>-->
<!--                        </li>-->
<!--                    </ul>-->

<!--                    <hr/>-->
<!--                    <form th:action="@{/notifications/run}" method="post" class="row g-2">-->
<!--                        <div class="col-6">-->
<!--                            <input class="form-control form-control-sm" name="fridgeId" placeholder="fridgeId" value="1">-->
<!--                        </div>-->
<!--                        <div class="col-3">-->
<!--                            <input class="form-control form-control-sm" name="days" placeholder="days" value="3">-->
<!--                        </div>-->
<!--                        <div class="col-3">-->
<!--                            <button class="btn btn-sm btn-warning w-100" type="submit">Batch</button>-->
<!--                        </div>-->
<!--                        <div class="text-muted small">Ручной запуск проверки уведомлений (для демо)</div>-->
<!--                    </form>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout(~{::section})}">
<section>
    <h4 class="page-title mb-3">Dashboard</h4>

    <div class="row g-3 mb-4">
        <div class="col-md-4">
            <div class="card stat-card h-100">
                <div class="card-body">
                    <div class="text-muted small">Количество продуктов</div>
                    <div class="stat-value" th:text="${productCount}">0</div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card stat-card h-100">
                <div class="card-body">
                    <div class="text-muted small">Количество холодильников</div>
                    <div class="stat-value" th:text="${fridgeCount}">0</div>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card stat-card h-100">
                <div class="card-body">
                    <div class="text-muted small">Скоро испортятся</div>
                    <div class="stat-value" th:text="${expiringSoon.size()}">0</div>
                </div>
            </div>
        </div>
    </div>

    <div class="row g-3">
        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-header">Мои продукты</div>
                <div class="card-body">
                    <a class="btn btn-primary btn-sm mb-2" th:href="@{/products/my}">Открыть список</a>

                    <div th:if="${#lists.isEmpty(myProducts)}" class="text-muted">Пока пусто</div>

                    <ul class="list-group" th:if="${!#lists.isEmpty(myProducts)}">
                        <li class="list-group-item d-flex justify-content-between align-items-center"
                            th:each="p : ${myProducts}">
                            <div>
                                <div class="fw-semibold" th:text="${p.name()}">Product</div>
                                <div class="text-muted small" th:text="${p.status()}">STATUS</div>
                            </div>
                            <div class="text-muted small">
                                <span th:if="${p.expiresAt() != null}"
                                      th:text="${#temporals.format(p.expiresAt(), 'dd.MM.yyyy HH:mm')}"></span>
                                <span th:if="${p.expiresAt() == null}">—</span>
                            </div>
                        </li>
                    </ul>

                    <div class="mt-3" th:if="${!#lists.isEmpty(expiringSoon)}">
                        <div class="fw-semibold mb-2">Скоро испортятся</div>
                        <ul class="list-group">
                            <li class="list-group-item d-flex justify-content-between align-items-center"
                                th:each="p : ${expiringSoon}">
                                <span th:text="${p.name()}">Product</span>
                                <span class="text-muted small" th:text="${#temporals.format(p.expiresAt(), 'dd.MM.yyyy HH:mm')}">
                                    01.01.2026
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card h-100">
                <div class="card-header">Холодильники</div>
                <div class="card-body">

                    <div th:if="${#lists.isEmpty(fridges)}" class="text-muted">Пока нет холодильников</div>

                    <ul class="list-group" th:if="${!#lists.isEmpty(fridges)}">
                        <li class="list-group-item d-flex justify-content-between align-items-center"
                            th:each="f : ${fridges}">
                            <span>
                                <b th:text="${f.name}">Fridge</b>
                                <span class="text-muted" th:text="${f.location}">Location</span>
                            </span>

                            <span class="d-flex gap-2">
                                <form th:action="@{/fridges/{id}/join(id=${f.fridgeId})}" method="post" class="m-0">
                                    <button class="btn btn-outline-primary btn-sm" type="submit">Открыть</button>
                                </form>
                                <a class="btn btn-outline-secondary btn-sm"
                                   th:href="@{/fridges/{id}/map(id=${f.fridgeId})}">Карта</a>
                            </span>
                        </li>
                    </ul>

                    <hr/>

                    <form th:action="@{/notifications/run}" method="post" class="row g-2">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <div class="col-6">
                            <input class="form-control form-control-sm" name="fridgeId" placeholder="fridgeId" value="1">
                        </div>
                        <div class="col-3">
                            <input class="form-control form-control-sm" name="days" placeholder="days" value="3">
                        </div>
                        <div class="col-3">
                            <button class="btn btn-sm btn-warning w-100" type="submit">Batch</button>
                        </div>
                        <div class="text-muted small">Ручной запуск проверки уведомлений (для демо)</div>
                    </form>

                </div>
            </div>
        </div>
    </div>
</section>
</html>
